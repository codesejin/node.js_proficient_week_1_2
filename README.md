# node.js_proficient_week_1_2
node.js ìˆ™ë ¨ì£¼ì°¨ - cookie, session

- ì¿ í‚¤ì™€ ì„¸ì…˜ì´ë€?
    - **ì¿ í‚¤(Cookie)**: ë¸Œë¼ìš°ì €ê°€ ì„œë²„ë¡œë¶€í„° ì‘ë‹µìœ¼ë¡œ **Set-Cookie** í—¤ë”ë¥¼ ë°›ì€ ê²½ìš° í•´ë‹¹ ë°ì´í„°ë¥¼ ì €ì¥í•œ ë’¤ ëª¨ë“  ìš”ì²­ì— í¬í•¨í•˜ì—¬ ë³´ëƒ…ë‹ˆë‹¤.
        - ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ì‚¬ì´íŠ¸ì— ê³µìœ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë³´ì•ˆì— ì·¨ì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        - ì¿ í‚¤ëŠ” `userId=user-1321;userName=sparta` ì™€ ê°™ì´ ë¬¸ìì—´ í˜•ì‹ìœ¼ë¡œ ì¡´ì¬í•˜ë©° ì¿ í‚¤ ê°„ì—ëŠ” ì„¸ë¯¸ì½œë¡ `(;)` ìœ¼ë¡œ êµ¬ë¶„ë©ë‹ˆë‹¤.
    - **ì„¸ì…˜(Session):** ì¿ í‚¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì„±ëœ ê¸°ìˆ ì…ë‹ˆë‹¤. ë‹¨, í´ë¼ì´ì–¸íŠ¸ê°€ ë§ˆìŒëŒ€ë¡œ ë°ì´í„°ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆë˜ ì¿ í‚¤ì™€ëŠ” ë‹¤ë¥´ê²Œ ì„¸ì…˜ì€ ë°ì´í„°ë¥¼ **ì„œë²„**ì—ë§Œ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— ë³´ì•ˆì´ ì¢‹ìœ¼ë‚˜, ë°˜ëŒ€ë¡œ ì‚¬ìš©ìê°€ ë§ì€ ê²½ìš° ì„œë²„ì— ì €ì¥í•´ì•¼ í•  ë°ì´í„°ê°€ ë§ì•„ì ¸ì„œ ì„œë²„ ì»´í“¨í„°ê°€ ê°ë‹¹í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œê°€ ìƒê¸°ê¸° ì‰½ìŠµë‹ˆë‹¤.

## 1. cookie : backend api ì½”ë“œ : ì„œë²„ -> í´ë¼ì´ì–¸íŠ¸
- ì¿ í‚¤(Cookie) ë§Œë“¤ì–´ë³´ê¸°
ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ HTTP ìš”ì²­(Request)ì„ ìˆ˜ì‹ í•  ë•Œ, ì„œë²„ëŠ” ì‘ë‹µ(Response)ê³¼ í•¨ê»˜ Set-Cookie ë¼ëŠ” í—¤ë”ë¥¼ í•¨ê»˜ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ê·¸ í›„ ì¿ í‚¤ëŠ” í•´ë‹¹ ì„œë²„ì— ì˜í•´ ë§Œë“¤ì–´ì§„ ì‘ë‹µ(Response)ê³¼ í•¨ê»˜ Cookie HTTP í—¤ë”ì•ˆì— í¬í•¨ë˜ì–´ ì „ë‹¬ë°›ìŠµë‹ˆë‹¤.

```
// ì„œë²„ -> í´ë¼ì´ì–¸íŠ¸ ì¿ í‚¤ í• ë‹¹
app.get("/set-cookie", (req, res) => {
    let expires = new Date();
    expires.setMinutes(expires.getMinutes() + 60); // ë§Œë£Œ ì‹œê°„ì„ 60ë¶„ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

    res.cookie('name', 'sparta', {
    expires: expires
});
 return res.status(200).end();
});
```

### ê°œë°œìë„êµ¬ í™•ì¸ : name = spartë¼ê³  response í• ë‹¹
![image](https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/d5057ec4-72c0-469e-b4a7-592374787d6d)
### ê°œë°œìë„êµ¬ í™•ì¸ : 5002í¬íŠ¸ì—ì„œ ì¿ í‚¤ë¥¼ í• ë‹¹ ë°›ì•˜ìŒì„ ì¸ì§€
![image](https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/c9dfd07b-b6e4-4515-86e0-4ad56a6b728e)


## 2. cookie : backend api ì½”ë“œ : í´ë¼ì´ì–¸íŠ¸ -> ì„œë²„ 
- reqë¥¼ ì´ìš©í•˜ì—¬ ì¿ í‚¤ ì ‘ê·¼í•˜ê¸°
(ì¿ í‚¤ì— ìˆëŠ” ë°ì´í„°ê°€ ì„œë²„ì— ì •ìƒì ìœ¼ë¡œ ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸)

**í´ë¼ì´ì–¸íŠ¸**ëŠ” **ì„œë²„**ì— **ìš”ì²­(Request)** ë¥¼ ë³´ë‚¼ ë•Œ **ìì‹ ì´ ë³´ìœ í•˜ê³  ìˆëŠ” ì¿ í‚¤**ë¥¼ **ìë™ìœ¼ë¡œ ì„œë²„**ì— ì „ë‹¬í•˜ê²Œ ëœë‹¤.

ì—¬ê¸°ì„œ **í´ë¼ì´ì–¸íŠ¸**ê°€ ì „ë‹¬í•˜ëŠ” ì¿ í‚¤ ì •ë³´ëŠ” **Request header**ì— í¬í•¨ë˜ì–´ ì„œë²„ì— ì „ë‹¬ë˜ê²Œ ëœë‹¤.

ê·¸ë ‡ë‹¤ë©´ **ì„œë²„**ì—ì„œ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì¿ í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ê¹Œ?

ì¼ë°˜ì ìœ¼ë¡œ ì¿ í‚¤ëŠ” `req.headers.cookie`ì— ë“¤ì–´ìˆë‹¤. `req.headers`ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ **Request**ì˜ í—¤ë”ë¥¼ ì˜ë¯¸í•œë‹¤

```
// í´ë¼ì´ì–¸íŠ¸ -> ì„œë²„ ì¿ í‚¤ ì •ë³´ ì „ë‹¬
app.get("/get-cookie", (req, res) => {
    const cookie = req.headers.cookie;
    console.log(cookie); // name=sparta
    return res.status(200).json({ cookie });
});
```

### í”„ë¡ íŠ¸ response í™•ì¸
![image](https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/8abc9262-002a-446f-b8f8-fcba16836a8a)


## 3. cookie-parse ë¯¸ë“¤ì›¨ì–´ ì ìš©
**cookie-parser ë¯¸ë“¤ì›¨ì–´**ëŠ” ìš”ì²­ì— ì¶”ê°€ëœ ì¿ í‚¤ë¥¼ req.cookies ê°ì²´ë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.

ë”ì´ìƒ `req.headers.cookie`ì™€ ê°™ì´ ë²ˆê±°ë¡­ê²Œ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤
```npm install cookie-parser ```


```
const cookieParser = require("cookie-parser");
app.use(cookieParser());

// í´ë¼ì´ì–¸íŠ¸ -> ì„œë²„ ì¿ í‚¤ ì •ë³´ ì „ë‹¬
app.get("/get-cookie", (req, res) => {
    // const cookie = req.headers.cookie;
    const cookies = req.cookies; // cookieparser ë¯¸ë“¤ì›¨ì–´ë¥¼ ì ìš©í–ˆê¸° ë•Œë¬¸ì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    console.log(cookies); // name=sparta
    return res.status(200).json({ cookies });
});
```

### Thunder client í™•ì¸ 1
<img width="1392" alt="image" src="https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/7225421c-48f5-4ccb-b4cd-66f17c1a43fe">

### Thunder clinet í™•ì¸ 2
ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ë•ŒëŠ” ë¬¸ìì—´ë¡œ ì¶œë ¥ì´ ë˜ëŠ”ë°, ë¯¸ë“¤ì›¨ì–´ ì‚¬ìš©í•˜ë©´ ê°ì²´ í˜•íƒœë¡œ ì¶œë ¥ëœë‹¤
<img width="1387" alt="image" src="https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/af5885bd-b12e-4e17-a7a8-29e61540d944">


## 4. session : backend api ì½”ë“œ 1

**ì¿ í‚¤**ì˜ ê²½ìš° ì„œë²„ë¥¼ ì¬ì‹œì‘í•˜ê±°ë‚˜ ìƒˆë¡œê³ ì¹¨ì„ í•˜ë”ë¼ë„ ë¡œê·¸ì¸ì´ ìœ ì§€ë©ë‹ˆë‹¤. 

ì‚¬ìš©ìì˜ ì…ì¥ì—ì„œëŠ” í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ ì„œë²„ì˜ ì…ì¥ì—ì„œëŠ” ìƒë‹¹íˆ ìœ„í—˜í•œ ìƒí™©ì…ë‹ˆë‹¤. 

ì¿ í‚¤ê°€ ì¡°ì‘ë˜ê±°ë‚˜ ë…¸ì¶œë˜ëŠ” ê²½ìš° ë³´ì•ˆì ìœ¼ë¡œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ë ‡ë‹¤ë©´, **ì¿ í‚¤**ì—ëŠ” ì–´ë– í•œ ì •ë³´ë¥¼ í• ë‹¹í•´ì•¼ í• ê¹Œìš”? 

ì‚¬ìš©ìê°€ **ëˆ„êµ¬ì¸ì§€ í™•ì‹¤í•˜ê²Œ êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ì •ë³´**ë¥¼ ë„£ì–´ì£¼ì–´ì•¼ í•  ê²ƒ ì…ë‹ˆë‹¤! ğŸ™‚

ê·¸ë ‡ê²Œ í–ˆì„ ë•Œ, **ë¯¼ê°í•œ ì •ë³´**ëŠ” ì„œë²„ì—ì„œë§Œ ê´€ë¦¬í•˜ê³ , ì‚¬ìš©ìê°€ ëˆ„êµ¬ì¸ì§€ **êµ¬ë¶„í•  ìˆ˜ ìˆëŠ” ì •ë³´**ë¥¼ í†µí•´ ì‚¬ìš©ìì˜ íŠ¹ì •í•œ ì •ë³´ë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆê²Œ ë  ê²ƒì…ë‹ˆë‹¤. ğŸ˜Š

ì„¸ì…˜ì„ ì €ì¥í• ë•Œ, í•´ë‹¹í•˜ëŠ” ì‚¬ìš©ìì˜ ì •ë³´ê°€ spartaë¼ëŠ” ë¬¸ìì—´ì´ ì„¸ì…˜ì— ì €ì¥ë˜ë„ë¡ ë§Œë“¬
```
// ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ì €ì¥í•  ë§Œí•œ ìë¬¼ì‡ (ë°ì´í„°ë¥¼ ì €ì¥í•˜ëŠ” ë¿)
let session = {}; // session ê°ì²´ ìƒì„± : Key - value()
app.get("/set-session", (req,res) => {
    const name = "sparta"; // ì„¸ì„ ì— ì €ì¥ ë°ì´í„°
    const uniqueInt = Date.now(); // í´ë¼ì´ì–¸íŠ¸ì—ê²Œ í• ë‹¹í•œ ì—´ì‡ ê°€ uniqueIntë¡œ ë˜ì–´ìˆìŒ
    // ì—´ì‡ ê°€ ë“¤ì–´ì™”ì„ë•Œ ì„œë²„ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ì „ë‹¬í•´ì¤˜ì•¼ í•˜ê¸° ë•Œë¬¸ì— uniqueIntë¥¼ ì„¸ì…˜ì˜ í‚¤ë¡œ ì‚¬ìš©
    session[uniqueInt] = name; // ì„¸ì„ ì— ë°ì´í„° ì €ì¥

    res.cookie("sessionKey", uniqueInt);
    res.status(200).end();

});
```

### Thunder client í™•ì¸ 
ì´ë¦„ì€ sessionKey, valueëŠ” ë°ì´í„°ë¥¼ ì €ì¥í–ˆë˜ ê·¸ ì‹œì ì— ì •ë³´ê°€ ìƒì„±

ì´ api ë‹¤ìŒì—ëŠ” ì €ì¥ëœ ì—´ì‡ (value)ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì„œë²„ì— ë°ì´í„°ë¥¼ ì¡°íšŒí•´ì•¼í•œë‹¤

<img width="1397" alt="image" src="https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/48818995-a069-4660-a1c0-90d13f6df2be">

## 5. session : backend api ì½”ë“œ 2

```
app.get("/get-session", (req, res) => {
    // ì‚¬ìš©ìì˜ ì¿ í‚¤ì•ˆì— ìˆëŠ” sessionKeyë¼ëŠ” ì¿ í‚¤ë¥¼ ê°€ì ¸ì™€ì•¼ í•œë‹¤.
    const {sessionKey} = req.cookies;
    // sessionKeyë¼ëŠ” ì¿ í‚¤ë¥¼ ë°”íƒ•ìœ¼ë¡œ session[]ì´ë¼ëŠ” ìë¬¼ì‡ ë¥¼ ì—´ê³ , ê²°ê³¼ê°’ì„ sessionItemë¼ëŠ” ë³€ìˆ˜ì— í• ë‹¹í•œë‹¤
    const sessionItem = session[sessionKey]

    console.log(sessionItem);
    return res.status(200).json({sessionItem: sessionItem});
});

app.listen(5002, () => {
    console.log(5002, "í¬íŠ¸ë¡œ ì„œë²„ê°€ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.")
})
```

### Thunder client í™•ì¸ 
<img width="1384" alt="image" src="https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/0e668378-8415-48c6-a90c-66c5d2e29df4">

---

> **ë³µìŠµí•˜ê¸°**
> 
> ì¿ í‚¤ì— ì €ì¥ë˜ì–´ìˆëŠ” ë¸Œë¼ìš°ì €ì˜ ì—´ì‡ ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì„¸ì…˜ì„ ì¡°íšŒí•´ë³´ë‹ˆê¹Œ 
> ì •ìƒì ìœ¼ë¡œ ì²˜ìŒ ì €ì¥ë˜ì–´ìˆë˜ spartaë¼ëŠ” ë¬¸ìì—´ì´ ì¶œë ¥ë¨
> 
>![image](https://github.com/codesejin/node.js_proficient_week_1_2/assets/101460733/dd2c576f-9eab-426f-afc0-f20f97c8a087)


